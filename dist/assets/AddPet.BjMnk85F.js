import{j as e}from"./mui.Bkkoi8jQ.js";import{r as s}from"./vendor.7ih_MNs0.js";import{f as a,d as t}from"./index.B6-xA0SR.js";import{F as r,I as l,P as i,a0 as n,B as d,m as o,U as m,a1 as c,s as u}from"./antd.ByzEhNMT.js";const{Option:h}=i,p=()=>{const[p]=r.useForm(),[g,j]=s.useState(!1),x=async e=>{const s=new FormData;s.append("file",e),s.append("upload_preset","havendogs");try{return(await t.post("https://api.cloudinary.com/v1_1/tracysoft/image/upload",s)).data.secure_url}catch(a){throw u.error("Failed to upload image"),a}};return e.jsx("div",{className:"p-4",children:e.jsxs(r,{form:p,layout:"vertical",onFinish:async e=>{var s,t;try{j(!0);const r=[];if(null==(s=e.photo)?void 0:s.fileList)for(const s of e.photo.fileList){const e=await x(s.originFileObj);r.push(e)}const l=(null==(t=e.medicalHistory)?void 0:t.map((e=>{var s;return{condition:e.condition,diagnosis:e.diagnosis,treatment:e.treatment,date:null==(s=e.date)?void 0:s.toISOString(),notes:e.notes}})))||[],i={name:e.name,type:e.type,breed:e.breed,age:e.age,gender:e.gender,weight:e.weight,pictures:r,medicalHistory:l,vaccinations:[],specialNeeds:[]};if(!(await fetch(`${a.baseURL}/auth/pets`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(i)})).ok)throw new Error("Failed to add pet");u.success("Pet added successfully!"),p.resetFields()}catch(r){u.error("Failed to add pet. Please try again.")}finally{j(!1)}},className:"max-w-2xl mx-auto",children:[e.jsx(r.Item,{name:"name",label:"Pet Name",rules:[{required:!0,message:"Please input your pet's name!"}],children:e.jsx(l,{size:"large"})}),e.jsx(r.Item,{name:"type",label:"Pet Type",rules:[{required:!0,message:"Please select your pet type!"}],children:e.jsxs(i,{size:"large",children:[e.jsx(h,{value:"dog",children:"Dog"}),e.jsx(h,{value:"cat",children:"Cat"}),e.jsx(h,{value:"bird",children:"Bird"}),e.jsx(h,{value:"other",children:"Other"})]})}),e.jsx(r.Item,{name:"breed",label:"Breed",rules:[{required:!0,message:"Please input your pet's breed!"}],children:e.jsx(l,{size:"large"})}),e.jsx(r.Item,{name:"age",label:"Age",rules:[{required:!0,message:"Please input your pet's age!"}],children:e.jsx(l,{size:"large",placeholder:"e.g. 2 years, 6 months"})}),e.jsx(r.Item,{name:"gender",label:"Gender",rules:[{required:!0,message:"Please select your pet's gender!"}],children:e.jsxs(i,{size:"large",children:[e.jsx(h,{value:"male",children:"Male"}),e.jsx(h,{value:"female",children:"Female"})]})}),e.jsx(r.Item,{name:"weight",label:"Weight (kg)",rules:[{required:!0,message:"Please input your pet's weight!"}],children:e.jsx(l,{type:"number",size:"large"})}),e.jsx(r.List,{name:"medicalHistory",children:(s,{add:a})=>e.jsxs(e.Fragment,{children:[s.map((({key:s,name:a,...t})=>e.jsxs("div",{className:"border p-4 mb-4 rounded",children:[e.jsx(r.Item,{...t,name:[a,"condition"],label:"Condition",rules:[{required:!0,message:"Please input the condition!"}],children:e.jsx(l,{placeholder:"Enter condition"})}),e.jsx(r.Item,{...t,name:[a,"diagnosis"],label:"Diagnosis",rules:[{required:!0,message:"Please input the diagnosis!"}],children:e.jsx(l,{placeholder:"Enter diagnosis"})}),e.jsx(r.Item,{...t,name:[a,"treatment"],label:"Treatment",rules:[{required:!0,message:"Please input the treatment!"}],children:e.jsx(l,{placeholder:"Enter treatment"})}),e.jsx(r.Item,{...t,name:[a,"date"],label:"Date",rules:[{required:!0,message:"Please select the date!"}],children:e.jsx(n,{style:{width:"100%"}})}),e.jsx(r.Item,{...t,name:[a,"notes"],label:"Notes",children:e.jsx(l.TextArea,{placeholder:"Enter additional notes"})})]},s))),e.jsx(r.Item,{children:e.jsx(d,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(o,{}),children:"Add Medical History Entry"})})]})}),e.jsx(r.Item,{name:"photo",label:"Pet Photos",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:null==e?void 0:e.fileList,children:e.jsx(m,{listType:"picture",beforeUpload:()=>!1,multiple:!0,children:e.jsx(d,{icon:e.jsx(c,{}),children:"Upload Photos"})})}),e.jsx(r.Item,{children:e.jsx(d,{type:"primary",htmlType:"submit",size:"large",loading:g,className:"w-full",children:"Add Pet"})})]})})};export{p as default};
