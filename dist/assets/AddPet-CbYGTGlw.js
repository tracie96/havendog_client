import{j as e,a0 as P}from"./index-Dsq4HvsK.js";import{r as I}from"./vendor-Dk2ZNgAq.js";import{F as s,I as i,G as p,Q as w,B as m,R as q,U as F,V as E,s as u}from"./antd-CgienqUN.js";const{Option:d}=p,D=()=>{const[h]=s.useForm(),[x,g]=I.useState(!1),j=async t=>{const a=new FormData;a.append("file",t),a.append("upload_preset","havendogs");try{return(await P.post("https://api.cloudinary.com/v1_1/tracysoft/image/upload",a)).data.secure_url}catch(l){throw u.error("Failed to upload image"),l}},y=async t=>{var a,l;try{g(!0);const r=[];if((a=t.photo)!=null&&a.fileList)for(const o of t.photo.fileList){const c=await j(o.originFileObj);r.push(c)}const n=((l=t.medicalHistory)==null?void 0:l.map(o=>{var c;return{condition:o.condition,diagnosis:o.diagnosis,treatment:o.treatment,date:(c=o.date)==null?void 0:c.toISOString(),notes:o.notes}}))||[],b={name:t.name,type:t.type,breed:t.breed,age:t.age,gender:t.gender,weight:t.weight,pictures:r,medicalHistory:n,vaccinations:[],specialNeeds:[]};if((await fetch("http://localhost:5000/api/auth/pets",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(b)})).ok)u.success("Pet added successfully!"),h.resetFields();else throw new Error("Failed to add pet")}catch{u.error("Failed to add pet. Please try again.")}finally{g(!1)}},f=t=>Array.isArray(t)?t:t==null?void 0:t.fileList;return e.jsx("div",{className:"p-4",children:e.jsxs(s,{form:h,layout:"vertical",onFinish:y,className:"max-w-2xl mx-auto",children:[e.jsx(s.Item,{name:"name",label:"Pet Name",rules:[{required:!0,message:"Please input your pet's name!"}],children:e.jsx(i,{size:"large"})}),e.jsx(s.Item,{name:"type",label:"Pet Type",rules:[{required:!0,message:"Please select your pet type!"}],children:e.jsxs(p,{size:"large",children:[e.jsx(d,{value:"dog",children:"Dog"}),e.jsx(d,{value:"cat",children:"Cat"}),e.jsx(d,{value:"bird",children:"Bird"}),e.jsx(d,{value:"other",children:"Other"})]})}),e.jsx(s.Item,{name:"breed",label:"Breed",rules:[{required:!0,message:"Please input your pet's breed!"}],children:e.jsx(i,{size:"large"})}),e.jsx(s.Item,{name:"age",label:"Age",rules:[{required:!0,message:"Please input your pet's age!"}],children:e.jsx(i,{size:"large",placeholder:"e.g. 2 years, 6 months"})}),e.jsx(s.Item,{name:"gender",label:"Gender",rules:[{required:!0,message:"Please select your pet's gender!"}],children:e.jsxs(p,{size:"large",children:[e.jsx(d,{value:"male",children:"Male"}),e.jsx(d,{value:"female",children:"Female"})]})}),e.jsx(s.Item,{name:"weight",label:"Weight (kg)",rules:[{required:!0,message:"Please input your pet's weight!"}],children:e.jsx(i,{type:"number",size:"large"})}),e.jsx(s.List,{name:"medicalHistory",children:(t,{add:a})=>e.jsxs(e.Fragment,{children:[t.map(({key:l,name:r,...n})=>e.jsxs("div",{className:"border p-4 mb-4 rounded",children:[e.jsx(s.Item,{...n,name:[r,"condition"],label:"Condition",rules:[{required:!0,message:"Please input the condition!"}],children:e.jsx(i,{placeholder:"Enter condition"})}),e.jsx(s.Item,{...n,name:[r,"diagnosis"],label:"Diagnosis",rules:[{required:!0,message:"Please input the diagnosis!"}],children:e.jsx(i,{placeholder:"Enter diagnosis"})}),e.jsx(s.Item,{...n,name:[r,"treatment"],label:"Treatment",rules:[{required:!0,message:"Please input the treatment!"}],children:e.jsx(i,{placeholder:"Enter treatment"})}),e.jsx(s.Item,{...n,name:[r,"date"],label:"Date",rules:[{required:!0,message:"Please select the date!"}],children:e.jsx(w,{style:{width:"100%"}})}),e.jsx(s.Item,{...n,name:[r,"notes"],label:"Notes",children:e.jsx(i.TextArea,{placeholder:"Enter additional notes"})})]},l)),e.jsx(s.Item,{children:e.jsx(m,{type:"dashed",onClick:()=>a(),block:!0,icon:e.jsx(q,{}),children:"Add Medical History Entry"})})]})}),e.jsx(s.Item,{name:"photo",label:"Pet Photos",valuePropName:"fileList",getValueFromEvent:f,children:e.jsx(F,{listType:"picture",beforeUpload:()=>!1,multiple:!0,children:e.jsx(m,{icon:e.jsx(E,{}),children:"Upload Photos"})})}),e.jsx(s.Item,{children:e.jsx(m,{type:"primary",htmlType:"submit",size:"large",loading:x,className:"w-full",children:"Add Pet"})})]})})};export{D as default};
