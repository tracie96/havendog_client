import{j as e}from"./mui.gQp_5HAj.js";import{r as a}from"./vendor.7ih_MNs0.js";import{e as s,d as r}from"./index.BItEAo24.js";import{F as t,I as i,Q as l,a1 as n,B as d,m as o,U as m,a2 as c,s as u}from"./antd.DHghpK7B.js";const{Option:h}=l,p=()=>{const[p]=t.useForm(),[g,j]=a.useState(!1),x=async e=>{const a=new FormData;a.append("file",e),a.append("upload_preset","havendogs");try{return(await r.post("https://api.cloudinary.com/v1_1/tracysoft/image/upload",a)).data.secure_url}catch(s){throw u.error("Failed to upload image"),s}};return e.jsx("div",{className:"p-4",children:e.jsxs(t,{form:p,layout:"vertical",onFinish:async e=>{var a,r;try{j(!0);const t=[];if(null==(a=e.photo)?void 0:a.fileList)for(const a of e.photo.fileList){const e=await x(a.originFileObj);t.push(e)}const i=(null==(r=e.medicalHistory)?void 0:r.map((e=>{var a;return{condition:e.condition,diagnosis:e.diagnosis,treatment:e.treatment,date:null==(a=e.date)?void 0:a.toISOString(),notes:e.notes}})))||[],l={name:e.name,type:e.type,breed:e.breed,age:e.age,gender:e.gender,weight:e.weight,pictures:t,medicalHistory:i,veterinarian:e.veterinarian||null,vaccinations:[],specialNeeds:[]};if(!(await fetch(`${s.baseURL}/auth/pets`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify(l)})).ok)throw new Error("Failed to add pet");u.success("Pet added successfully!"),p.resetFields()}catch(t){u.error("Failed to add pet. Please try again.")}finally{j(!1)}},className:"max-w-2xl mx-auto",children:[e.jsx(t.Item,{name:"name",label:"Pet Name",rules:[{required:!0,message:"Please input your pet's name!"}],children:e.jsx(i,{size:"large"})}),e.jsx(t.Item,{name:"type",label:"Pet Type",rules:[{required:!0,message:"Please select your pet type!"}],children:e.jsxs(l,{size:"large",children:[e.jsx(h,{value:"dog",children:"Dog"}),e.jsx(h,{value:"cat",children:"Cat"}),e.jsx(h,{value:"bird",children:"Bird"}),e.jsx(h,{value:"other",children:"Other"})]})}),e.jsx(t.Item,{name:"breed",label:"Breed",rules:[{required:!0,message:"Please input your pet's breed!"}],children:e.jsx(i,{size:"large"})}),e.jsx(t.Item,{name:"age",label:"Age",rules:[{required:!0,message:"Please input your pet's age!"}],children:e.jsx(i,{size:"large",placeholder:"e.g. 2 years, 6 months"})}),e.jsx(t.Item,{name:"gender",label:"Gender",rules:[{required:!0,message:"Please select your pet's gender!"}],children:e.jsxs(l,{size:"large",children:[e.jsx(h,{value:"male",children:"Male"}),e.jsx(h,{value:"female",children:"Female"})]})}),e.jsx(t.Item,{name:"weight",label:"Weight (kg)",rules:[{required:!0,message:"Please input your pet's weight!"}],children:e.jsx(i,{type:"number",size:"large"})}),e.jsx(t.Item,{name:"veterinarian",label:"Personal Veterinarian",children:e.jsx(i,{size:"large",placeholder:"Your personal veterinarian's name and contact (optional)"})}),e.jsx(t.List,{name:"medicalHistory",children:(a,{add:s})=>e.jsxs(e.Fragment,{children:[a.map((({key:a,name:s,...r})=>e.jsxs("div",{className:"border p-4 mb-4 rounded",children:[e.jsx(t.Item,{...r,name:[s,"condition"],label:"Condition",rules:[{required:!0,message:"Please input the condition!"}],children:e.jsx(i,{placeholder:"Enter condition"})}),e.jsx(t.Item,{...r,name:[s,"diagnosis"],label:"Diagnosis",rules:[{required:!0,message:"Please input the diagnosis!"}],children:e.jsx(i,{placeholder:"Enter diagnosis"})}),e.jsx(t.Item,{...r,name:[s,"treatment"],label:"Treatment",rules:[{required:!0,message:"Please input the treatment!"}],children:e.jsx(i,{placeholder:"Enter treatment"})}),e.jsx(t.Item,{...r,name:[s,"date"],label:"Date",rules:[{required:!0,message:"Please select the date!"}],children:e.jsx(n,{style:{width:"100%"}})}),e.jsx(t.Item,{...r,name:[s,"notes"],label:"Notes",children:e.jsx(i.TextArea,{placeholder:"Enter additional notes"})})]},a))),e.jsx(t.Item,{children:e.jsx(d,{type:"dashed",onClick:()=>s(),block:!0,icon:e.jsx(o,{}),children:"Add Medical History Entry"})})]})}),e.jsx(t.Item,{name:"photo",label:"Pet Photos",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:null==e?void 0:e.fileList,children:e.jsx(m,{listType:"picture",beforeUpload:()=>!1,multiple:!0,children:e.jsx(d,{icon:e.jsx(c,{}),children:"Upload Photos"})})}),e.jsx(t.Item,{children:e.jsx(d,{type:"primary",htmlType:"submit",size:"large",loading:g,className:"w-full",children:"Add Pet"})})]})})};export{p as default};
